<!DOCTYPE html>
<html>

    <head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>How to integrate Apache Spark, Intellij Idea and Scala</title>

<meta name="description" content="Want to develop machine learning algorithms using Apache Spark, IntelliJ and Scala SBT? Step by step tutorial. How to create Spark Scala SBT ptoject in Intellij.">
<link rel="profile" href="http://gmpg.org/xfn/11" />
<link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css">
<!-- <link rel="stylesheet" href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css"> -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" type="text/css" media="all" href="/css/style.css" />
<link rel="stylesheet" type="text/css" media="all" href="/css/jquery.mmenu.all.css" />
<link rel="stylesheet" href="/css/highlightjs.piperita.css">

<!-- Favicons generated at http://realfavicongenerator.net/ -->
<link rel="apple-touch-icon" sizes="57x57" href="/favicons/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="/favicons/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="/favicons/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="/favicons/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="/favicons/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="/favicons/apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="/favicons/apple-touch-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="/favicons/apple-touch-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="/favicons/apple-touch-icon-180x180.png">
<link rel="icon" type="image/png" href="/favicons/icon.png" sizes="32x32">
<link rel="icon" type="image/png" href="/favicons/icon.png" sizes="192x192">
<link rel="icon" type="image/png" href="/favicons/icon.png" sizes="96x96">
<link rel="icon" type="image/png" href="/favicons/icon.png" sizes="16x16">
<link rel="manifest" href="/favicons/manifest.json">
<link rel="shortcut icon" href="/favicons/icon.png">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-TileImage" content="/favicons/mstile-144x144.png">
<meta name="msapplication-config" content="/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-76210007-1', 'auto');
  ga('send', 'pageview');

</script>



</head>

    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-76210007-1', 'auto');
  ga('send', 'pageview');

</script>
    <body>

    <nav id="my-menu">
  <div>
    <p>Volodymyr Miz</p>

    <ul class="pages">
      <li><a href="/"><i class="fa fa-home"></i> Home</a></li>
      <li><a href="/posts/"><i class="fa fa-archive"></i> All Posts</a></li>
      <li><a href="/search/"><i class="fa fa-search"></i> Search</a></li>
    </ul>

    <p class="links">
	
	<a href="https://www.linkedin.com/in/volodymyrmiz" target="_new"><i class="fa fa-linkedin"></i></a>
	<a href="https://github.com/mizvol" target="_new"><i class="fa fa-github-alt"></i></a>
	<a href="CV-Volodymyr-Miz.pdf" target="_new"><i class="fa fa-id-card"></i></a>
	<a href="https://twitter.com/mizvladimir" target="_new"><i class="fa fa-twitter"></i></a>
	<a href="feed.xml" target="_new"><i class="fa fa-rss"></i></a>
</p>

  </div>
</nav>
<div class="menu-button" href="#menu"><i class="fa fa-bars"></i></div>


    <div class="page-content">
      <div class="wrap">
      

<div class="container-fluid single">
  <div class="row">

    <div itemscope itemtype="http://schema.org/Article" class="col-md-12 article">
      
      <div class="thumb">
        <i class="fa fa-lightbulb-o fa-4x"></i>
      </div>
      

      <h1 class="header" itemprop="name">How to integrate Apache Spark, Intellij Idea and Scala</h1>

      <div class="author">
        <small><i>
          
          by
          <span itemprop="author">
            
              <a rel="author" href="https://miz.space/">
            
            <span itemprop="author" itemscope itemtype="http://schema.org/Person">
              <span itemprop="name">Volodymyr Miz</span>
            </span>
            
              </a>
            
          </span>
          
          on <span itemprop="datePublished" content="2014-08-28">August 30, 2016</span>
           under Tutorial
        </i></small>
      </div>

      <div class="read-time">
        <small>
          4 minute read
        </small>
      </div>

      <div class="content-panel content">

        

        <span itemprop="articleBody"><p>Updated 7 June 2020.</p>

<p>Here is a quick 1-minute walk through tutorial on how to create a Spark Scala SBT project in IntelliJ Idea IDE. If you need more detailed instructions, keep scrolling and you will find them below.</p>

<div style="position:relative;height:0;padding-bottom:56.25%"><iframe src="https://www.youtube.com/embed/XLgzBqrEZ0U?ecver=2" width="640" height="360" frameborder="0" gesture="media" style="position:absolute;width:100%;height:100%;left:0" allowfullscreen=""></iframe></div>

<p><img src="/data/images/scalaIJSpark.png" alt="Intellij Scala Spark" height="50%" width="50%" align="right" /></p>

<p>I love <a href="http://jupyter.org/">Jupyter Notebook</a>. It is really useful when I want to present some code, let someone reproduce my research or just learn how to use new tools and libraries. I use Jupyter almost every day and, as many others, when I first started learning Spark I developed my first data analysis pipelines using interactive notebooks and Python API. Then I have realized that I wanted more and running notebooks locally was not enough for me, so in 2015, I signed up for <a href="https://databricks.com/try-databricks">Databricks Community Ediditon</a> subscription. Databricks allowed to forget about the problems related to setting up and maintaining the environment.</p>

<p>Everyone who is learning and using Spark eventually realizes that Python API is not as powerful and flexible as the core language of the framework - Scala. This language allows to start feeling the full power of Spark comprising analytics, streaming and graph processing tools. However, Spark is just yet another framework for large scale data analytics. Yes, it is convenient and powerful, but it has a limited number of algorithms and sometimes you need to implement your own custom algorithm. And that is the moment when you need an IDE.</p>

<h3 id="motivation">Motivation</h3>
<p>I faced this problem for the first time in 2016, when we decided to implement a recommendation algorithm that was recently developed in <a href="https://lts2.epfl.ch/">LTS2</a> where I just started my PhD. The algorithm had a custom loss function, gradient, update rules and tricky optimization part, so I could not use the recommendation algorithms already implemented in Spark (e. g. ALS). But this is the topic for another blogpost. Now we are going to create Spark Scala project in Intellij Idea IDE.</p>

<h3 id="create-spark-scala-project-in-intellij-idea">Create Spark Scala project in Intellij Idea</h3>
<p>I decided to use <a href="https://www.jetbrains.com/idea/download/">Intellij Idea Community Edition</a> and I am going to show how to run Apache Spark programs written in Scala using this IDE. I assume that you have already installed the IDE, Scala plugin, SBT and JDK. If you do not have them installed, do that first:</p>
<ul>
  <li><a href="https://www.scala-sbt.org/1.x/docs/Installing-sbt-on-Linux.html">install SBT and JDK</a></li>
  <li><a href="https://www.jetbrains.com/idea/download/">install Intellij Idea and Scala plugin</a></li>
</ul>

<p>I have tested this tutorial on Ubuntu 16.04 and 18.04, Windows 8, and MacOS Catalina.</p>

<h4 id="1-create-scala-project">1. Create Scala project</h4>
<p>Once you have everything installed, first step is to create SBT-based Scala project. Your JDK, Scala and SBT versions may vary but make sure that they are compatible with Spark libraries that you are going to use.</p>

<p><img src="/data/images/createProject1.png" alt="Create SBT-based Scala Project. 1st Step" />
<img src="/data/images/createProject2.png" alt="Create SBT-based Scala Project. 2nd Step" /></p>

<h4 id="2-add-libraries">2. Add libraries</h4>
<p>Next step is to add a few Spark libraries to the project. To do that, update the content of the <code class="highlighter-rouge">build.sbt</code> file simply by copying and pasting the code below. In this example I added Spark Core and Spark SQL libraries. If you need to use other libraries, you can find them in <a href="https://mvnrepository.com/artifact/org.apache.spark">Maven repository</a>.</p>

<p><img src="/data/images/addSparkLibraries.png" alt="Add spark libraries" /></p>

<noscript><pre>400: Invalid request</pre></noscript>
<script src="https://gist.github.com/1fb152e33de96808cc2d2b7608d26cf2.js"> </script>

<!-- ```java
name := "SparkScalaTest"

version := "1.0"

scalaVersion := "2.10.4"

libraryDependencies ++= Seq(
  "org.apache.spark" % "spark-core_2.10" % "2.0.0",
  "org.apache.spark" % "spark-sql_2.10" % "2.0.0"
)
``` -->

<p>Rebuild the project. You might also need to open the console in IntelliJ (<code class="highlighter-rouge">ALT + F12</code>) and type:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sbt</span> <span class="n">plugins</span> <span class="n">update</span>
</code></pre></div></div>
<p>Sometimes this is done automatically, but if the compiler says that something is undefined, run this command in order to force the download process.</p>

<h4 id="3-run-spark-program">3. Run Spark program</h4>
<p>Now we can check if the project works. Create a Scala class (e.g. in <code class="highlighter-rouge">src/main/scala</code> folder) and run a simple word count example.</p>

<p><img src="/data/images/sparkIntellij.png" alt="Run Spark in Itellij" /></p>

<noscript><pre>400: Invalid request</pre></noscript>
<script src="https://gist.github.com/925deaa88e2f47ed17a2f8a866bf196f.js"> </script>

<!-- ```java
import org.apache.spark.sql.SparkSession

object SparkWordCount {
  def main(args: Array[String]): Unit = {

    val spark = SparkSession.builder
      .master("local")
      .appName("Spark Graph Frames")
      .getOrCreate()

    val lines = spark.sparkContext.parallelize(Seq("Spark Intellij Idea Scala test one", "Spark Intellij Idea Scala test two", "Spark Intellij Idea Scala test three"))

    val counts = lines.flatMap(line => line.split(" "))
      .map(word => (word, 1))
      .reduceByKey(_ + _)

    counts.foreach(println)
  }
}
``` -->

<p>Alternatively, you can check out a similar project from my <a href="https://github.com/mizvol/SparkTest">GitHub repository</a>.</p>

<p>That’s it. Now you can build your custom Machine Learning algorithms using Scala, Apache Spark and Intellij Idea IDE.</p>

<p>Happy coding!</p>

</span>

        


        
        <div class="tags">
          <small>
          <i class="fa fa-tags"></i>
            Apache Spark, Intellij Idea, Scala, Development, Machine Learning, Tutorial, Install
          </small>
        </div>
        

      </div>

      
      <div class="content-panel feedback">
        I <i class="fa fa-heart"></i> feedback.<br />
        Let me know what you think of this article on twitter <a href="http://www.twitter.com/mizvladimir">@mizvladimir</a> or leave a comment below!
      </div>
      

      
      <div class="content-panel comments">
        <div id="disqus_thread">
          <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
          <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
        </div>
      </div>
      

      

    </div>

  </div>

</div>

<div id="disqus_thread"></div>
<script>
    /**
     *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
     *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
     */
    /*
    var disqus_config = function () {
        this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
        this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
    */
    (function() {  // DON'T EDIT BELOW THIS LINE
        var d = document, s = d.createElement('script');
        
        s.src = '//mizspace.disqus.com/embed.js';
        
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
      </div>
    </div>

    <div class="footer clearfix">
  <div class="col-md-5  pull-left">
    Powered by <a href="https://jekyllrb.com ">Jekyll</a>
  </div>
  <div class="col-md-5 pull-right">
    Jekyll template <a href="https://github.com/jacobtomlinson/carte-noire"><i class="fa fa-github"></i></a>
  </div>
</div>

<script src="//code.jquery.com/jquery-1.11.0.min.js"></script>
<script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
<script src="/js/jquery.mmenu.min.all.js"></script>
<script src="/js/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<script type="text/javascript">
   $(document).ready(function() {
      $("#my-menu").mmenu().on( "closed.mm", function() {
            $(".menu-button").show();
         });
      $(".menu-button").click(function() {
        $(".menu-button").hide();
        $("#my-menu").trigger("open.mm");
      });
   });
</script>




<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-76210007-1']);
          _gaq.push(['_trackPageview']);
  (function () {
      var ga = document.createElement('script');
      ga.type = 'text/javascript';
      ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';

      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(ga, s);
  })();
</script>



    </body>
</html>
